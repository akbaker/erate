--CREATE TABLE
DROP TABLE IF EXISTS analysis.nces_private_2011;
CREATE TABLE analysis.nces_private_2011
(
	PFNLWT int,
	REPW1 int,
	REPW2 int,
	REPW3
	REPW4
	REPW5
	REPW6
	REPW7
	REPW8
	REPW9
	REPW10
	REPW11
	REPW12
	REPW13
	REPW14
	REPW15
	REPW16
	REPW17
	REPW18
	REPW19
	REPW20
	REPW21
	REPW22
	REPW23
	REPW24
	REPW25
	REPW26
	REPW27
	REPW28
	REPW29
	REPW30
	REPW31
	REPW32
	REPW33
	REPW34
	REPW35
	REPW36
	REPW37
	REPW38
	REPW39
	REPW40
	REPW41
	REPW42
	REPW43
	REPW44
	REPW45
	REPW46
	REPW47
	REPW48
	REPW49
	REPW50
	REPW51
	REPW52
	REPW53
	REPW54
	REPW55
	REPW56
	REPW57
	REPW58
	REPW59
	REPW60
	REPW61
	REPW62
	REPW63
	REPW64
	REPW65
	REPW66
	REPW67
	REPW68
	REPW69
	REPW70
	REPW71
	REPW72
	REPW73
	REPW74
	REPW75
	REPW76
	REPW77
	REPW78
	REPW79
	REPW80
	REPW81
	REPW82
	REPW83
	REPW84
	REPW85
	REPW86
	REPW87
	REPW88
	CSOURCE
	UNGRD_OFR
	UNGRD_ENRL
	PREK_OFR
	PREK_ENRL
	KIND_OFR
	KIND_ENRL
	TRANSK_OFR
	TRANSK_ENRL
	TRANS1_OFR
	TRANS1_ENRL
	G1_OFR
	G1_ENRL
	G2_OFR
	G2_ENRL
	G3_OFR
	G3_ENRL
	G4_OFR
	G4_ENRL
	G5_OFR
	G5_ENRL
	G6_OFR
	G6_ENRL
	G7_OFR
	G7_ENRL
	G8_OFR
	G8_ENRL
	G9_OFR
	G9_ENRL
	G10_OFR
	G10_ENRL
	G11_OFR
	G11_ENRL
	G12_OFR
	G12_ENRL
	MEMBER
	HISP
	WHITE
	BLACK
	ASIAN
	PACIFIC_ISLAND
	INDIAN_ALASKA
	TWO_RACES
	COED
	MALE_STUDENTS
	STUDENTS_G12
	NUMBER_G12
	PCT_4YR_COLLEGE
	KIND_LENGTH
	KIND_DAYS
	TEACHERS_FT
	TEACHERS_3FORTHS
	TEACHERS_HT
	TEACHERS_QT
	TEACHERS_LESS_QT
	TOT_TEACHERS
	TYPE_SCHOOL
	HOMESCHOOL
	PRIVATE_HOME
	RELIGIOUS
	RELIG_AFFL
	RELIG_ORIENT
	CATHOLIC
	Q15_0
	Q15_1
	Q15_2
	Q15_3
	Q15_4
	Q15_5
	Q15_6
	Q15_7
	Q15_8
	Q15_9
	Q15_10
	Q15_11
	Q15_12
	Q15_13
	Q15_14
	Q15_15
	Q15_16
	Q15_17
	Q15_18
	Q15_19
	Q15_20
	Q15_21
	Q15_22
	Q15_23
	Q15_24
	Q15_25
	Q15_26
	Q15_27
	Q15_28
	Q15_29
	Q15_30
	Q15_31
	Q15_32
	Q15_33
	Q15_34
	Q15_35
	Q15_36
	Q15_37
	Q15_38
	Q15_39
	DAYS
	LENGTH_HOURS
	LENGTH_MINUTES
	LIBRARY
	RESPONSE_TIME
	PPIN
	PINST
	PADDRS
	PCITY
	PSTABB
	PZIP
	PZIP4
	PCNTY
	PCNTNM
	PL_ADD
	PL_CIT
	PL_STABB
	PL_ZIP
	PL_ZIP4
	REGION
	PSTANSI
	ULOCALE12
	LATITUDE12
	LONGITUDE12
	LOGR2012
	HIGR2012
	FRAME
	TABFLAG
	TYPOLOGY
	RELIG
	ORIENT
	DIOCESE
	LEVEL
	NUMSTUDS
	SIZE
	NUMTEACH
	UCOMMTYP
	TOTHRS
	MALES
	F_P135
	F_P140
	F_P145
	F_P150
	F_P155
	F_P160
	F_P165
	F_P170
	F_P
)	
WITH (
  OIDS=FALSE
);
ALTER TABLE analysis.nces_public_2011
  OWNER TO postgres;

SET client_encoding to 'latin1';
COPY analysis.nces_public_2011
	FROM '/Users/FCC/Documents/allison/data/public_school/sc111a_supp_apr21.txt';

--ADD GEOMETRY
ALTER table analysis.nces_public_2011 ADD COLUMN geom geometry(POINT,4326);
UPDATE analysis.nces_public_2011 SET geom = ST_SetSRID(ST_MakePoint(loncod,latcod),4326);
CREATE INDEX nces_public_2011_geom_gist ON analysis.nces_public_2011 USING GIST(geom);

--DROP FOREIGN DOD SCHOOLS
DELETE FROM analysis.nces_public_2011
WHERE FIPST = '63' AND latcod = 0 AND loncod = 0;